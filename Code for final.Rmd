---
title: "Analysis of US Accidents Data"
author: "Andrew J. Martinez"
date: "2024-11-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Introduction

In this analysis, we will explore the US Accidents Dataset available on Kaggle. This dataset contains information about traffic accidents across the United States, including various features such as accident locations, severity, weather conditions, and more. By analyzing this data, we aim to uncover trends and relationships between different factors that contribute to the frequency and severity of traffic accidents in the US.

##The dataset includes details such as:
The US Accidents Dataset contains detailed records of traffic accidents across the US. Key attributes include:

Start_Time: The date and time the accident occurred.
City: City where the accident took place.
Weather_Condition: Weather conditions at the time of the accident.
Road_Condition: Condition of the road (e.g., dry, wet, icy).
Severity: A numerical scale (1 to 4) indicating the severity of the accident (from minor to fatal).
Accident Type: Rear-end collisions, rollovers, etc.

#Questions:

1. Which cities have the highest number of accidents?
2. How do different weather conditions affect accident frequency?
3a. What is the accident severity by weather condition (Top 10)?
3b. What is the accident Severity by City (Top 10).

#Libraries Used: 
I used the following R libraries for data manipulation, exploration, and visualization:
```{r}
# Loading necessary libraries
library(tidyverse)   # for data manipulation and visualization
library(ggplot2)     # for data visualization
library(dplyr)       # for data wrangling
library(lubridate)   # for working with dates and times
library(scales)      # for better scale formatting in plots
library(knitr)       # for dynamic report generation
```

#Loading the Data
```{r}
accidents_data <- read.csv("US_Accidents.csv")

glimpse(accidents_data)
colnames(accidents_data)
```

#Data Exploration and Cleaning
To ensure accurate analysis, we must clean the dataset:

Removing missing values: We filter out records where critical information like Start_Time, City, or Weather_Condition is missing.
Cleaning up irrelevant columns: We remove unnecessary columns that do not contribute to our analysis.

```{r}
# Check for missing data
summary(accidents_data)

# Remove rows with NA in important columns (Start_Time, city, weather_condition)
accidents_data_clean <- accidents_data %>%
  filter(!is.na(Start_Time) & !is.na(City) & !is.na(Weather_Condition))

# Check the cleaned data structure
glimpse(accidents_data_clean)
```
#1. Most Accident-Prone Cities
To explore which Cities have the highest number of accidents, we will group the data by city and visualize the total number of accidents.
```{r}
# Group by city and count the number of accidents
accidents_by_city <- accidents_data_clean %>%
  group_by(City) %>%
  summarise(Accident_Count = n()) %>%
  arrange(desc(Accident_Count))

# Select the top 10 cities with the highest number of accidents
top_cities <- head(accidents_by_city, 10)

# Plot the top 10 most accident-prone cities
ggplot(top_cities, aes(x = reorder(City, Accident_Count), y = Accident_Count)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  coord_flip() +  # Flip axes for readability
  labs(title = "Top 10 Most Accident-Prone Cities", x = "City", y = "Number of Accidents") +
  theme_minimal()
```
The bar chart shows which cities have the highest frequency of accidents.

#Question 2. Weather Conditions and Accidents
Now we will investigate how different weather conditions affect the number of accidents.
```{r}
# Filter out rows where weather_condition is NA or empty before grouping
accidents_by_weather <- accidents_data_clean %>%
  filter(!is.na(Weather_Condition) & Weather_Condition != "") %>%
  group_by(Weather_Condition) %>%
  summarise(Accident_Count = n()) %>%
  arrange(desc(Accident_Count))

# Select the top 10 weather conditions
top_weather <- head(accidents_by_weather, 10)

# Plot accident frequency by weather condition
ggplot(top_weather, aes(x = reorder(Weather_Condition, Accident_Count), y = Accident_Count)) +
  geom_bar(stat = "identity", fill = "orange") +
  coord_flip() +
  labs(title = "Top 10 Weather Conditions for Accidents", x = "Weather Condition", y = "Number of Accidents") +
  theme_minimal()
options(scipen = 999)
```

#Additional Cleaning for Weather and Severity
```{r}
# Cleaning data to ensure no missing values in key columns (Severity, Weather_Condition, City)
accidents_data_clean <- accidents_data_clean %>%
  filter(!is.na(Severity), !is.na(Weather_Condition), !is.na(City))

# Summarize accidents by weather condition and severity
accidents_by_weather <- accidents_data_clean %>%
  group_by(Weather_Condition, Severity) %>%
  summarise(Accident_Count = n()) %>%
  arrange(desc(Accident_Count))

# Limit to top 10 weather conditions
top_weather_conditions <- accidents_by_weather %>%
  group_by(Weather_Condition) %>%
  summarise(Accident_Count = sum(Accident_Count)) %>%
  arrange(desc(Accident_Count)) %>%
  head(10)

# Filter to only include top 10 weather conditions
accidents_by_weather_top <- accidents_by_weather %>%
  filter(Weather_Condition %in% top_weather_conditions$Weather_Condition)

# Reorder Severity factor to ensure correct ordering (from 1 to 4)
accidents_by_weather_top$Severity <- factor(accidents_by_weather_top$Severity, levels = c(1, 2, 3, 4))
```

#Question 3a. Accident Severity by Weather Contition
```{r}
# Plot accident severity by weather condition (Top 10)
ggplot(accidents_by_weather_top, aes(x = reorder(Weather_Condition, Accident_Count), y = Accident_Count, fill = factor(Severity))) +
  geom_bar(stat = "identity", position = "stack") +
  coord_flip() +
  labs(title = "Accident Severity by Weather Condition (Top 10)", 
       x = "Weather Condition", 
       y = "Number of Accidents", 
       fill = "Severity") +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 8),  # Reduce size of y-axis labels for readability
        plot.title = element_text(size = 14),   # Adjust title size
        axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for better visibility
```

#Question 3b. Accident Severity by City
```{r}
# Summarize accidents by city and severity
accidents_by_city <- accidents_data_clean %>%
  group_by(City, Severity) %>%
  summarise(Accident_Count = n()) %>%
  arrange(desc(Accident_Count))

# Limit to top 10 cities with the most accidents
top_cities <- accidents_by_city %>%
  group_by(City) %>%
  summarise(Accident_Count = sum(Accident_Count)) %>%
  arrange(desc(Accident_Count)) %>%
  head(10)

# Filter to only include top 10 cities
accidents_by_city_top <- accidents_by_city %>%
  filter(City %in% top_cities$City)

# Reorder Severity factor to ensure correct ordering (from 1 to 4)
accidents_by_city_top$Severity <- factor(accidents_by_city_top$Severity, levels = c(1, 2, 3, 4))

# Plot accident severity by city (Top 10)
ggplot(accidents_by_city_top, aes(x = reorder(City, Accident_Count), y = Accident_Count, fill = factor(Severity))) +
  geom_bar(stat = "identity", position = "stack") +
  coord_flip() +
  labs(title = "Accident Severity by City (Top 10)", 
       x = "City", 
       y = "Number of Accidents", 
       fill = "Severity") +
  theme_minimal() +
  theme(axis.text.y = element_text(size = 8),  # Reduce size of y-axis labels for readability
        plot.title = element_text(size = 14),   # Adjust title size
        axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for better visibility
```

##Conclusion
In summary, our analysis of traffic accidents across the United States reveals several interesting insights:

In this analysis, I found that cities like Los Angeles, Charlotte, and Miami are among the most accident-prone areas in the United States, likely due to their high population density, heavy traffic, and geographical factors. When examining weather conditions, fair weather emerged as the most common condition for accidents, followed by cloudy and mostly cloudy conditions. Interestingly, accident severity across all weather conditions consistently hovered around level 2 (moderate severity). However, when looking closely at the counts, it became evident that accidents tend to be evenly distributed across severity levels, so the larger number of accidents in fair weather conditions likely explains the higher frequency of severity 2 accidents. This highlights that while fair weather may not seem hazardous, its sheer volume of accidents results in a higher proportion of moderate-severity crashes.

In terms of accident severity by city, Houston and Dallas stood out with notably higher occurrences of severity level 3 (serious accidents) compared to other cities. This could be indicative of factors such as road conditions, traffic patterns, or driving behaviors in these cities that contribute to more severe crashes. Overall, this analysis underscores the complexity of traffic accidents, where both environmental and geographical factors play significant roles. The findings suggest that cities with heavy traffic and more severe weather conditions need targeted safety initiatives, while moderate severity accidents in fair weather conditions still represent a significant portion of the overall accident data. In the future, I hope to explore further measures to address these patterns and reduce accident severity across different regions and conditions.